"use strict";(()=>{var e={};e.id=696,e.ids=[696],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2750:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>v,requestAsyncStorage:()=>u,routeModule:()=>c,serverHooks:()=>m,staticGenerationAsyncStorage:()=>d});var o={};r.r(o),r.d(o,{POST:()=>p});var a=r(9303),s=r(8716),n=r(670),i=r(7070),l=r(7372);async function p(e){try{let{roomId:e,hostPin:t,participantPin:r}=l.f.createRoom();return i.NextResponse.json({roomId:e,hostPin:t,participantPin:r,createdAt:new Date().toISOString()})}catch(e){return console.error("Error creating room:",e),i.NextResponse.json({error:"Failed to create room"},{status:500})}}let c=new a.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/rooms/route",pathname:"/api/rooms",filename:"route",bundlePath:"app/api/rooms/route"},resolvedPagePath:"/Users/rhule/.cursor/worktrees/share-app/xJVlP/conference-app/app/api/rooms/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:u,staticGenerationAsyncStorage:d,serverHooks:m}=c,h="/api/rooms/route";function v(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:d})}},4068:(e,t,r)=>{r.d(t,{v:()=>o});let o={cloudflare:{turnApiToken:process.env.CLOUDFLARE_TURN_API_TOKEN||"",turnTokenId:process.env.CLOUDFLARE_TURN_TOKEN_ID||"59d87715faf308d4ea571375623ec7a3"},websocket:{url:"http://localhost:3001",path:"/socket.io/"},redis:{url:process.env.REDIS_URL},room:{maxParticipants:10,pinLength:6,ttl:864e5},webrtc:{iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"}]},isDevelopment:!1}},7372:(e,t,r)=>{r.d(t,{f:()=>s});var o=r(4068);e=r.hmd(e);class a{constructor(){this.rooms=new Map,this.cleanupInterval=null,this.startCleanup()}generateRoomId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",t="";for(let r=0;r<8;r++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}generatePin(){return Math.floor(1e5+9e5*Math.random()).toString()}createRoom(){let e;do e=this.generateRoomId();while(this.rooms.has(e));let t=this.generatePin(),r=this.generatePin(),o={id:e,hostPin:t,participantPin:r,createdAt:Date.now(),lastActivity:Date.now(),participants:new Set};return this.rooms.set(e,o),{roomId:e,hostPin:t,participantPin:r}}validateRoom(e,t){let r=e.toUpperCase(),o=this.rooms.get(r);if(!o)return console.log(`Room not found: ${r}`),{isValid:!1,isHost:!1};o.lastActivity=Date.now();let a=t.trim();return a===o.hostPin?(console.log(`Host PIN validated for room ${r}`),{isValid:!0,isHost:!0,participantPin:o.participantPin}):a===o.participantPin?(console.log(`Participant PIN validated for room ${r}`),{isValid:!0,isHost:!1}):(console.log(`Invalid PIN for room ${r}: ${a}`),{isValid:!1,isHost:!1})}getRoom(e){return this.rooms.get(e.toUpperCase())}addParticipant(e,t){let r=this.rooms.get(e.toUpperCase());return!!r&&(r.participants.add(t),r.lastActivity=Date.now(),!0)}removeParticipant(e,t){let r=this.rooms.get(e.toUpperCase());return!!r&&(r.participants.delete(t),r.lastActivity=Date.now(),!0)}getParticipantCount(e){let t=this.rooms.get(e.toUpperCase());return t?t.participants.size:0}cleanup(){let e=Date.now(),t=o.v.room.ttl;this.rooms.forEach((r,o)=>{e-r.lastActivity>t&&(this.rooms.delete(o),console.log(`Cleaned up expired room: ${o}`))})}startCleanup(){this.cleanupInterval=setInterval(()=>{this.cleanup()},36e5)}stopCleanup(){this.cleanupInterval&&(clearInterval(this.cleanupInterval),this.cleanupInterval=null)}}let s=new a;e.exports&&(e.exports={roomStorage:s,RoomStorage:a})}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[948,972],()=>r(2750));module.exports=o})();